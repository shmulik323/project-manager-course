pipeline {
    agent none
    stages {
            stage('Git') {
            steps{
	    
                // echo 'Getting the code from GitHub...'
                git 'https://github.com/shmulik323/project-manager-course.git'
            }
        }
        stage('Back-end') {
            agent {
                docker { image 'python:3-alpine' }
            }
            steps {
              withEnv(["HOME=${env.WORKSPACE}"]) {
                    sh 'pip3.7 install -U -r requirements.txt --user'
		    	sh "cd api"
			sh "python3.7 appserver.py"
			sh "python3.7 test_front.py"
		            
                }
            }
        }
        stage('Front-end') {
            agent {
                docker { image 'node:7-alpine' }
            }
            steps {
	     withEnv(["HOME=${env.WORKSPACE}"]) {
	     	sh 'cd client'
                 sh 'npm install'
		 sh 'npm run dev' 
		 }
            }
        }
    }
}
