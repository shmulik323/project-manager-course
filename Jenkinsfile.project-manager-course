pipeline {
    agent none
    stages {

        stage('Front-end') {
            agent {
                docker { image 'node:10.15.3' }
            }
            steps {
	     withEnv(["HOME=${env.WORKSPACE}"]) {
	     	sh 'cd client && npm install  ckeditor/ckeditor5-theme-lark  '
		sh 'cd client   && npm run dev &'
		 }
            }
        }
	        stage('Back-end') {
            agent {
                docker { image 'python:3.7' }
            }
            steps {
              withEnv(["HOME=${env.WORKSPACE}"]) {
	      git 'https://github.com/shmulik323/project-manager-course.git'
                    sh 'pip3.7 install -U -r requirements.txt --user'
			sh "python3.7 api/appserver.py  &"
			sh "docker run -d \
--name firefox \
-e DISPLAY=$DISPLAY \
-v /tmp/.X11-unix:/tmp/.X11-unix \
kennethkl/firefox && python3.7 api/test_front.py "
		            
                }
            }
        }
    }
}
